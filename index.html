<!DOCTYPE html>
<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <title> APM Demo </title>
        <!--<link rel="stylesheet" href="css/index_style.css" type="text/css" />-->
    </head>
    <body>
        <div style="position: absolute; left: 33px; top: 15px"><h1>留言板</h1>
            <iframe id="UI" src="res/UI.svg" style="position: absolute; top: 0px; left: -32px; z-index: -1;" width="728" height="637" frameborder="no" scrolling="no"></iframe>
            <div id="bgdd" style="position: absolute; left: 10px; top: 107px; width: 160px; height: 460px;">
                        <img id="bgd" style="position: absolute; bottom: 0px" width="100%" />
			<div style="background-color: #66CCFF00; position:absolute; top: 0px; bottom: 0px; left: 0px; right: 0px;"></div>
            </div>
            <div id="msgbd" style="position: absolute; left: 10px; top: 107px; width: 160px; height: 460px; background-color: #0000">
		<p style="color: #66CCFF">生日快乐，洛天依</p>
	    </div>
            <div id="searchBD" style="position: absolute; left: 10px; top: 107px; width: 360px; height: 460px; background-color: #0000; display: none;">
                <iframe width="250%" height="250%" style="position: absolute; left: -280px; top: -335px; transform: scale(0.4)" src="ADBoard_forAPM/index.html" frameborder="no" scrolling="yes"></iframe>
		<button style="position: absolute; top:0; right: 0; width: 6mm; height: 6mm;border: none; background: transparent" id="closeSearchBD"><img src="res/del.svg" width="100%" height="100%"></button>
            </div>
            <input id="newmsg" type="text" style="position: absolute; left: 8px; top: 582px; width: 107px; height: 17px; background-color: #00000000; border: none" />
            <button id="send" style="position: absolute; left: 138px; top: 582px; width: 35px; height: 22px; background: transparent; background-color: #00000000; border: none"></button>
            <button id="search" style="position: absolute; left: 52.985008mm; top: 36.444225mm; width: 6mm; height: 6mm; background: transparent; background-color: #0000; border: none"></button>
        </div>
        <script>
            var counter = 0;
            document.getElementById("UI").width = window.innerWidth;
            document.getElementById("UI").height = window.innerHeight;
            var send = document.getElementById("send");
            send.onclick = function() {
                var msgbd = document.getElementById("msgbd");
                var newmsg = document.getElementById("newmsg");
                var item = document.createElement("a");
                var itemBGd = document.createElement("div");
                itemBGd.style.width = "0px";
                itemBGd.style.height = "0px";
                var itemBG = document.createElement("img");
                itemBG.src = "res/Msg.svg";
                itemBG.style.width = "40.327999mm";
                itemBG.style.height = "8.4110003mm";
                var blank = document.createElement("p");
                itemBGd.appendChild(blank);
                //itemBGd.appendChild(itemBG);
                //item.id="item" + counter++;
                var haslink = false;
                for(var i = 0; i < newmsg.value.length; i++) {           
                	if(newmsg.value.substring(i, 2) == "<a") {
                		haslink = true;
                	}
                }
                item.innerHTML = "<img style=\"width: 1ch\" />" + (haslink ? "不可以发送超链接哦" : newmsg.value);
                msgbd.appendChild(itemBGd);
                msgbd.appendChild(item);
                var delbutton = document.createElement("button");
                var delImg = document.createElement("img");
                delImg.src = "res/del.svg";
                delImg.width = "20.8";
                delImg.height = "20.8";
                //delImg.frameBorder = "no";
                var spliter = document.createElement("hr");
                delbutton.appendChild(delImg);
                delbutton.style.border = "none";
                delbutton.style.background = "transparent";
                delbutton.onclick = function() {
                    item.remove();
                    //itemBGd.remove();
                    spliter.remove();
                }
                item.appendChild(delbutton);
                newmsg.value = "";
                //item.innerHTML += "\n<hr />\n";
                var spliter = document.createElement("hr");
                msgbd.appendChild(spliter);
            }
            var newmsg = document.getElementById("newmsg");
            //newmsg.value = "[AD] 听说右边那个搜索好像可以用了诶！";
            //send.click();
            //newmsg.value = "[AD] 真的吗？真的吗？";
            //send.click();
            //newmsg.value = "[AD] 好耶！";
            //send.click();
            var searchBD_stat = false;
            search.onclick = function() {
                var msgbd = document.getElementById("msgbd");
                var searchBD = document.getElementById("searchBD");
                if(searchBD_stat) {
                    msgbd.style.display = "block";
                    searchBD.style.display = "none";
                    searchBD_stat = false;
                }
                else {
                    searchBD.style.display = "block";
                    msgbd.style.display = "none";
                    searchBD_stat = true;
                }
            }
	    function loadBG() {
	    var num = Math.floor(Math.random() * 6);
	    var bgd = document.getElementById("bgd");
	    bgd.src="/res/luotianyi/" + num + (num >= 2 ? ".jpg" : ".png");
		    setTimeout(loadBG, 31*1000);
	    }
	    loadBG();
	    var closeSearchBD = document.getElementById("closeSearchBD");
	    closeSearchBD.onclick = function() {
		search.click()
	    }
        </script>
    </body>
</html>
